(import omitted due to length; full file previously provided)